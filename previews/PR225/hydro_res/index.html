<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hydro Reservoir · Dolphyn.jl</title><meta name="title" content="Hydro Reservoir · Dolphyn.jl"/><meta property="og:title" content="Hydro Reservoir · Dolphyn.jl"/><meta property="twitter:title" content="Hydro Reservoir · Dolphyn.jl"/><meta name="description" content="Documentation for Dolphyn.jl."/><meta property="og:description" content="Documentation for Dolphyn.jl."/><meta property="twitter:description" content="Documentation for Dolphyn.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Dolphyn.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Welcome Page</a></li><li><a class="tocitem" href="../solvers/">Solvers</a></li><li><a class="tocitem" href="../dolphyn_model_introduction/">Model Introduction</a></li><li><span class="tocitem">Model Inputs/Outputs Documentation</span><ul><li><a class="tocitem" href="../global_data_documentation/">General Database Documentation</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">GenX Database Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../data_documentation/">Single-stage Model</a></li><li><a class="tocitem" href="../multi_stage_model_overview/">Multi-stage Model</a></li></ul></li><li><a class="tocitem" href="../hsc_data_documentation/">HSC Database Documentation</a></li><li><a class="tocitem" href="../csc_data_documentation/">CSC Database Documentation</a></li><li><a class="tocitem" href="../lfsc_data_documentation/">LFSC Database Documentation</a></li></ul></li><li><a class="tocitem" href="../objective_function/">Objective Function</a></li><li><span class="tocitem">GenX</span><ul><li><a class="tocitem" href="../model_introduction/">Model Introduction</a></li><li><a class="tocitem" href="../load_inputs/">GenX Inputs Functions</a></li><li><a class="tocitem" href="../write_outputs/">GenX Outputs Functions</a></li><li><a class="tocitem" href="../model_notation/">GenX Notation</a></li><li><a class="tocitem" href="../power_balance/">Power Balance</a></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">GenX Function Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../core/">Core</a></li><li><input class="collapse-toggle" id="menuitem-6-6-2" type="checkbox" checked/><label class="tocitem" for="menuitem-6-6-2"><span class="docs-label">Resources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../curtailable_variable_renewable/">Curtailable Variable Renewable</a></li><li><a class="tocitem" href="../flexible_demand/">Flexible Demand</a></li><li><input class="collapse-toggle" id="menuitem-6-6-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-6-6-2-3"><span class="docs-label">Hydro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Hydro Reservoir</a></li><li><a class="tocitem" href="../hydro_inter_period_linkage/">Long Duration Hydro</a></li></ul></li><li><a class="tocitem" href="../must_run/">Must Run</a></li><li><input class="collapse-toggle" id="menuitem-6-6-2-5" type="checkbox"/><label class="tocitem" for="menuitem-6-6-2-5"><span class="docs-label">Storage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../storage/">Storage</a></li><li><a class="tocitem" href="../investment_charge/">Investment Charge</a></li><li><a class="tocitem" href="../investment_energy/">Investment Energy</a></li><li><a class="tocitem" href="../long_duration_storage/">Long Duration Storage</a></li><li><a class="tocitem" href="../storage_all/">Storage All</a></li><li><a class="tocitem" href="../storage_asymmetric/">Storage Asymmetric</a></li><li><a class="tocitem" href="../storage_symmetric/">Storage Symmetric</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6-2-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6-2-6"><span class="docs-label">Thermal</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../thermal/">Thermal</a></li><li><a class="tocitem" href="../thermal_commit/">Thermal Commit</a></li><li><a class="tocitem" href="../thermal_no_commit/">Thermal No Commit</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-6-3"><span class="docs-label">Multi_stage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../configure_multi_stage_inputs/">Configure multi-stage inputs</a></li><li><a class="tocitem" href="../dual_dynamic_programming/">Model multi stage: Dual Dynamic Programming Algorithm</a></li></ul></li><li><a class="tocitem" href="../slack_variables_overview/">Slack Variables for Policies</a></li></ul></li><li><a class="tocitem" href="../load_inputs/">GenX Inputs Functions</a></li><li><a class="tocitem" href="../write_outputs/">GenX Outputs Functions</a></li><li><a class="tocitem" href="../additional_features/">Additional Features</a></li><li><a class="tocitem" href="../additional_third_party_extensions/">Third Party Extensions</a></li></ul></li><li><span class="tocitem">Hydrogen Supply Chain (HSC)</span><ul><li><a class="tocitem" href="../load_h2_inputs/">HSC Inputs Functions</a></li><li><a class="tocitem" href="../write_h2_outputs/">HSC Outputs Functions</a></li><li><a class="tocitem" href="../hsc_notation/">HSC Notation</a></li><li><a class="tocitem" href="../h2_balance/">HSC Supply-Demand Balance</a></li><li><input class="collapse-toggle" id="menuitem-7-5" type="checkbox"/><label class="tocitem" for="menuitem-7-5"><span class="docs-label">HSC Function Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../h2_core/">Hydrogen Core</a></li><li><a class="tocitem" href="../h2_flexible_demand/">Hydrogen Flexible Demand</a></li><li><a class="tocitem" href="../g2p/">Hydrogen to Power</a></li><li><input class="collapse-toggle" id="menuitem-7-5-4" type="checkbox"/><label class="tocitem" for="menuitem-7-5-4"><span class="docs-label">Hydrogen Storage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../h2_long_duration_storage/">Hydrogen Long Duration Storage</a></li><li><a class="tocitem" href="../h2_storage_all/">Hydrogen Storage ALL</a></li><li><a class="tocitem" href="../h2_storage_investment/">Hydrogen Storage Investment</a></li><li><a class="tocitem" href="../h2_storage/">Hydrogen Storage</a></li></ul></li><li><a class="tocitem" href="../h2_transmission/">Hydrogen Transmission</a></li><li><input class="collapse-toggle" id="menuitem-7-5-6" type="checkbox"/><label class="tocitem" for="menuitem-7-5-6"><span class="docs-label">Hydrogen Truck</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../h2_long_duration_truck/">Hydrogen Long Duration Truck</a></li><li><a class="tocitem" href="../h2_truck_all/">Hydrogen Truck All</a></li><li><a class="tocitem" href="../h2_truck_investment/">Hydrogen Truck Investment</a></li><li><a class="tocitem" href="../h2_truck/">Hydrogen Truck</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-5-7" type="checkbox"/><label class="tocitem" for="menuitem-7-5-7"><span class="docs-label">Hydrogen Production</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../h2_production_all/">Hydrogen Production All</a></li><li><a class="tocitem" href="../h2_production_commit/">Hydrogen Production Commit</a></li><li><a class="tocitem" href="../h2_production_no_commit/">Hydrogen Production No Commit</a></li><li><a class="tocitem" href="../h2_production/">Hydrogen Production</a></li></ul></li></ul></li></ul></li><li><span class="tocitem">CO2 Supply Chain (CSC)</span><ul><li><a class="tocitem" href="../load_co2_inputs/">CSC Inputs Functions</a></li><li><a class="tocitem" href="../write_co2_outputs/">CSC Outputs Functions</a></li><li><a class="tocitem" href="../csc_notation/">CSC Notation</a></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">CSC Function Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../co2_core/">CSC Core</a></li><li><a class="tocitem" href="../co2_capture/">CO2 Capture</a></li><li><a class="tocitem" href="../co2_compression/">CO2 Compression</a></li><li><a class="tocitem" href="../co2_storage/">CO2 Storage</a></li><li><a class="tocitem" href="../co2_transmission/">CO2 Transmission</a></li></ul></li></ul></li><li><span class="tocitem">Liquid Fuels Supply Chain (LFSC)</span><ul><li><a class="tocitem" href="../load_liquid_fuels_inputs/">LFSC Inputs Functions</a></li><li><a class="tocitem" href="../write_liquid_fuels_outputs/">LFSC Outputs Functions</a></li><li><a class="tocitem" href="../lfsc_notation/">LFSC Notation</a></li><li><input class="collapse-toggle" id="menuitem-9-4" type="checkbox"/><label class="tocitem" for="menuitem-9-4"><span class="docs-label">LFSC Function Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../liquid_fuels_core/">LFSC Core</a></li><li><a class="tocitem" href="../liquid_fuels_demand/">LF Demand</a></li><li><a class="tocitem" href="../liquid_fuels_resources/">LF Resources</a></li></ul></li></ul></li><li><a class="tocitem" href="../additional_tools/">Additional Tools</a></li><li><a class="tocitem" href="../solve_model/">Solving the Model</a></li><li><a class="tocitem" href="../methods/">Methods</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">GenX</a></li><li><a class="is-disabled">GenX Function Reference</a></li><li><a class="is-disabled">Resources</a></li><li><a class="is-disabled">Hydro</a></li><li class="is-active"><a href>Hydro Reservoir</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hydro Reservoir</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/macroenergy/Dolphyn.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/macroenergy/Dolphyn.jl/blob/main/docs/src/hydro_res.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hydro-Resources"><a class="docs-heading-anchor" href="#Hydro-Resources">Hydro Resources</a><a id="Hydro-Resources-1"></a><a class="docs-heading-anchor-permalink" href="#Hydro-Resources" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dolphyn.hydro_res!-Tuple{JuMP.Model, Dict, Dict}" href="#Dolphyn.hydro_res!-Tuple{JuMP.Model, Dict, Dict}"><code>Dolphyn.hydro_res!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">hydro_res!(EP::Model, inputs::Dict, setup::Dict)</code></pre><p>This module defines the operational constraints for reservoir hydropower plants. Hydroelectric generators with water storage reservoirs (<span>$y \in \mathcal{W}$</span>) are effectively modeled as energy storage devices that cannot charge from the grid and instead receive exogenous inflows to their storage reservoirs, reflecting stream flow inputs. For resources with unknown reservoir capacity (<span>$y \in \mathcal{W}^{nocap}$</span>), their operation is parametrized by their generation efficiency, <span>$\eta_{y,z}^{down}$</span>, and energy inflows to the reservoir at every time-step, represented as a fraction of the total power capacity,(<span>$\rho^{max}_{y,z,t}$</span>).  In case reservoir capacity is known (<span>$y \in \mathcal{W}^{cap}$</span>), an additional parameter, <span>$\mu^{stor}_{y,z}$</span>, referring to the ratio of energy capacity to discharge power capacity, is used to define the available reservoir storage capacity. <strong>Storage inventory balance</strong> Reservoir hydro systems are governed by the storage inventory balance constraint given below. This constraint enforces that energy level of the reservoir resource <span>$y$</span> and zone <span>$z$</span> in time step <span>$t$</span> (<span>$\Gamma_{y,z,t}$</span>) is defined as the sum of the reservoir level in the previous time step, less the amount of electricity generated, <span>$\Theta_{y,z,t}$</span> (accounting for the generation efficiency, <span>$\eta_{y,z}^{down}$</span>), minus any spillage <span>$\varrho_{y,z,t}$</span>, plus the hourly inflows into the reservoir (equal to the installed reservoir discharged capacity times the normalized hourly inflow parameter <span>$\rho^{max}_{y,z, t}$</span>).</p><p class="math-container">\[\begin{aligned}
&amp;\Gamma_{y,z,t} = \Gamma_{y,z,t-1} -\frac{1}{\eta_{y,z}^{down}}\Theta_{y,z,t} - \varrho_{y,z,t} + \rho^{max}_{y,z,t} \times \Delta^{total}_{y,z}  \hspace{.1 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}^{interior} \\
&amp;\Gamma_{y,z,t} = \Gamma_{y,z,t+\tau^{period}-1} -\frac{1}{\eta_{y,z}^{down}}\Theta_{y,z,t} - \varrho_{y,z,t} + \rho^{max}_{y,z,t} \times \Delta^{total}_{y,z}  \hspace{.1 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}^{start}
\end{aligned}\]</p><p>We implement time-wrapping to endogenize the definition of the intial state prior to the first period with the following assumption. If time step <span>$t$</span> is the first time step of the year then storage inventory at <span>$t$</span> is defined based on last time step of the year. Alternatively, if time step <span>$t$</span> is the first time step of a representative period, then storage inventory at <span>$t$</span> is defined based on the last time step of the representative period. Thus, when using representative periods, the storage balance constraint for hydro resources does not allow for energy exchange between representative periods. Note: in future updates, an option to model hydro resources with large reservoirs that can transfer energy across sample periods will be implemented, similar to the functions for modeling long duration energy storage in <code>long_duration_storage.jl</code>. <strong>Ramping Limits</strong> The following constraints enforce hourly changes in power output (ramps down and ramps up) to be less than the maximum ramp rates (<span>$\kappa^{down}_{y,z}$</span> and <span>$\kappa^{up}_{y,z}$</span> ) in per unit terms times the total installed capacity of technology y (<span>$\Delta^{total}_{y,z}$</span>).</p><p class="math-container">\[\begin{aligned}
&amp;\Theta_{y,z,t} + f_{y,z,t} + r_{y,z,t} - \Theta_{y,z,t-1} - f_{y,z,t-1} \leq \kappa^{up}_{y,z} \times \Delta^{total}_{y,z}
\hspace{2 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
&amp;\Theta_{y,z,t-1} + f_{y,z,t-1}  + r_{y,z,t-1} - \Theta_{y,z,t} - f_{y,z,t}\leq \kappa^{down}_{y,z} \Delta^{total}_{y,z}
\hspace{2 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>Ramping constraints are enforced for all time steps except the first time step of the year or first time of each representative period when using representative periods to model grid operations. <strong>Power generation and stream flow bounds</strong> Electricity production plus total spilled power from hydro resources is constrained to always be above a minimum output parameter, <span>$\rho^{min}_{y,z}$</span>, to represent operational constraints related to minimum stream flows or other demands for water from hydro reservoirs. Electricity production is constrained by either the the net installed capacity or by the energy level in the reservoir in the prior time step, whichever is more binding. For the latter constraint, the constraint for the first time step of the year (or the first time step of each representative period) is implemented based on energy storage level in last time step of the year (or last time step of each representative period).</p><p class="math-container">\[\begin{aligned}
&amp;\Theta_{y,z,t} + \varrho_{y,z,t}  \geq \rho^{min}_{y,z} \times \Delta^{total}_{y,z}
\hspace{2 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
\Theta_{y,t}  \leq \times \Delta^{total}_{y,z}
\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t\in \mathcal{T}
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
\Theta_{y,z,t} \leq  \Gamma_{y,t-1}
\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t\in \mathcal{T}
\end{aligned}\]</p><p><strong>Reservoir energy capacity constraint</strong> In case the reservoir capacity is known (<span>$y \in W^{cap}$</span>), then an additional constraint enforces the total stored energy in each time step to be less than or equal to the available reservoir capacity. Here, the reservoir capacity is defined multiplying the parameter, <span>$\mu^{stor}_{y,z}$</span> with the available power capacity.</p><p class="math-container">\[\begin{aligned}
\Gamma_{y,z, t} \leq \mu^{stor}_{y,z}\times \Delta^{total}_{y,z}
\hspace{4 cm}  \forall y \in \mathcal{W}^{cap}, z \in \mathcal{Z}, t\in \mathcal{T}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Dolphyn.jl/blob/v0.2.3/src/GenX/src/model/resources/hydro/hydro_res.jl#L1-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dolphyn.hydro_res_reserves!-Tuple{JuMP.Model, Dict}" href="#Dolphyn.hydro_res_reserves!-Tuple{JuMP.Model, Dict}"><code>Dolphyn.hydro_res_reserves!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">hydro_res_reserves!(EP::Model, inputs::Dict)</code></pre><p>This module defines the modified constraints and additional constraints needed when modeling operating reserves <strong>Modifications when operating reserves are modeled</strong> When modeling operating reserves, the constraints regarding maximum power flow limits are modified to account for procuring some of the available capacity for frequency regulation (<span>$f_{y,z,t}$</span>) and &quot;updward&quot; operating (or spinning) reserves (<span>$r_{y,z,t}$</span>).</p><p class="math-container">\[\begin{aligned}
 \Theta_{y,z,t} + f_{y,z,t} +r_{y,z,t}  \leq  \times \Delta^{total}_{y,z}
\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t\in \mathcal{T}
\end{aligned}\]</p><p>The amount of downward frequency regulation reserves cannot exceed the current power output.</p><p class="math-container">\[\begin{aligned}
 f_{y,z,t} \leq \Theta_{y,z,t}
\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p><p>The amount of frequency regulation and operating reserves procured in each time step is bounded by the user-specified fraction (<span>$\upsilon^{reg}_{y,z}$</span>,<span>$\upsilon^{rsv}_{y,z}$</span>) of nameplate capacity for each reserve type, reflecting the maximum ramp rate for the hydro resource in whatever time interval defines the requisite response time for the regulation or reserve products (e.g., 5 mins or 15 mins or 30 mins). These response times differ by system operator and reserve product, and so the user should define these parameters in a self-consistent way for whatever system context they are modeling.</p><p class="math-container">\[\begin{aligned}
f_{y,z,t} \leq \upsilon^{reg}_{y,z} \times \Delta^{total}_{y,z}
\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T} \\
r_{y,z, t} \leq \upsilon^{rsv}_{y,z}\times \Delta^{total}_{y,z}
\hspace{4 cm}  \forall y \in \mathcal{W}, z \in \mathcal{Z}, t \in \mathcal{T}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Dolphyn.jl/blob/v0.2.3/src/GenX/src/model/resources/hydro/hydro_res.jl#L151-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Dolphyn.hydro_inter_period_linkage!-Tuple{JuMP.Model, Dict}" href="#Dolphyn.hydro_inter_period_linkage!-Tuple{JuMP.Model, Dict}"><code>Dolphyn.hydro_inter_period_linkage!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">hydro_inter_period_linkage!(EP::Model, inputs::Dict)</code></pre><p>This function creates variables and constraints enabling modeling of long duration storage resources when modeling representative time periods. <strong>Storage inventory balance at beginning of each representative period</strong> The constraints in this section are used to approximate the behavior of long-duration energy storage technologies when approximating annual grid operations by modeling operations over representative periods. Previously, the state of charge balance for storage (as defined in <code>storage_all()</code>) assumed that state of charge at the beginning and end of each representative period has to be the same. In other words, the amount of energy built up or consumed by storage technology <span>$o$</span> in zone <span>$z$</span> over the representative period <span>$m$</span>, <span>$\Delta Q_{o,z,m} = 0$</span>. This assumption implicitly excludes the possibility of transferring energy from one representative period to the other which could be cost-optimal when the capital cost of energy storage capacity is relatively small. To model long-duration energy storage using representative periods, we replace the state of charge equation, such that the first term on the right hand side accounts for change in storage inventory associated with representative period <span>$m$</span> (<span>$\Delta Q_{o,z,m}$</span>), which could be positive (net accumulation) or negative (net reduction).</p><p class="math-container">\[\begin{aligned}
&amp; \Gamma_{o,z,(m-1)\times \tau^{period}+1 } =\left(1-\eta_{o,z}^{loss}\right)\times \left(\Gamma_{o,z,m\times \tau^{period}} -\Delta Q_{o,z,m}\right) -  \\
&amp; \frac{1}{\eta_{o,z}^{discharge}}\Theta_{o,z,(m-1)\times \tau^{period}+1} + \eta_{o,z}^{charge}\Pi_{o,z,(m-1)\times \tau^{period}+1} \quad \forall o \in \mathcal{O}^{LDES}, z \in \mathcal{Z}, m \in \mathcal{M}
\end{aligned}\]</p><p>By definition <span>$\mathcal{T}^{start}=\{\left(m-1\right) \times \tau^{period}+1 | m \in \mathcal{M}\}$</span>, which implies that this constraint is defined for all values of <span>$t \in T^{start}$</span>. <strong>Storage inventory change input periods</strong> We need additional variables and constraints to approximate energy exchange between representative periods, while accounting for their chronological occurence in the original input time series data and the possibility that two representative periods may not be adjacent to each other (see Figure below). To implement this, we introduce a new variable <span>$Q_{o,z, n}$</span> that models inventory of storage technology <span>$o \in O$</span> in zone <span>$z$</span> in each input period <span>$n \in \mathcal{N}$</span>. Additionally we define a function mapping, <span>$f: n \rightarrow m$</span>, that uniquely maps each input period <span>$n$</span> to its corresponding representative period <span>$m$</span>. This mapping is available as an output of the process used to identify representative periods (E.g. k-means clustering <a href="https://www.sciencedirect.com/science/article/pii/S0360544218315238?casa_token=I-6GVNMtAVIAAAAA:G8LFXFqXxRGrXHtrzmiIGm02BusIUmm83zKh8xf1BXY81-dTnA9p2YI1NnGuzlYBXsxK12by">Mallapragada et al., 2018</a>). <img src="../assets/LDES_approach.png" alt="Modeling inter-period energy exchange via long-duration storage when using representative period temporal resolution to approximate annual grid operations"/> <em>Figure. Modeling inter-period energy exchange via long-duration storage when using representative period temporal resolution to approximate annual grid operations</em> The following two equations define the storage inventory at the beginning of each input period <span>$n+1$</span> as the sum of storage inventory at begining of previous input period <span>$n$</span> plus change in storage inventory for that period. The latter is approximated by the change in storage inventory in the corresponding representative period, identified per the mapping <span>$f(n)$</span>.  The second constraint relates the storage level of the last input period, <span>$|N|$</span>, with the storage level at the beginning of the first input period. Finally, if the input period is also a representative period, then a third constraint enforces that initial storage level estimated by the intra-period storage balance constraint should equal the initial storage level estimated from the inter-period storage balance constraints. Note that <span>$|N|$</span> refers to the last modeled period.</p><p class="math-container">\[\begin{aligned}
&amp; Q_{o,z,n+1} = Q_{o,z,n} + \Delta Q_{o,z,f(n)}
\quad \forall  o \in \mathcal{O}^{LDES}, z \in \mathcal{Z}, n \in \mathcal{N}\setminus\{|N|\}
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
&amp; Q_{o,z,1} = Q_{o,z,|N|} + \Delta Q_{o,z,f(|N|)}
\quad \forall  o \in \mathcal{O}^{LDES}, z \in \mathcal{Z}, n = |N|
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
&amp; Q_{o,z,n} =\Gamma_{o,z,f(n)\times \tau^{period}} - \Delta Q_{o,z,m}
\quad \forall  o \in \mathcal{O}^{LDES}, z \in \mathcal{Z}, n \in   \mathcal{N}^{rep},
\end{aligned}\]</p><p>Finally, the next constraint enforces that the initial storage level for each input period <span>$n$</span> must be less than the installed energy capacity limit. This constraint ensures that installed energy storage capacity is consistent with the state of charge during both the operational time periods <span>$t$</span> during each sample period <span>$m$</span> as well as at the start of each chronologically ordered input period <span>$n$</span> in the full annual time series.</p><p class="math-container">\[\begin{aligned}
    Q_{o,z,n} \leq \Delta^{total, energy}_{o,z}
\quad \forall n \in \mathcal{N}, o \in \mathcal{O}^{LDES}
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/macroenergy/Dolphyn.jl/blob/v0.2.3/src/GenX/src/model/resources/hydro/hydro_inter_period_linkage.jl#L1-L43">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../flexible_demand/">« Flexible Demand</a><a class="docs-footer-nextpage" href="../hydro_inter_period_linkage/">Long Duration Hydro »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 8 February 2024 06:52">Thursday 8 February 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
